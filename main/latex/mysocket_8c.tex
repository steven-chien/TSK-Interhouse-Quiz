\hypertarget{mysocket_8c}{\section{src/mysocket.c File Reference}
\label{mysocket_8c}\index{src/mysocket.\-c@{src/mysocket.\-c}}
}
{\ttfamily \#include $<$stdio.\-h$>$}\\*
{\ttfamily \#include $<$stdlib.\-h$>$}\\*
{\ttfamily \#include $<$sys/ioctl.\-h$>$}\\*
{\ttfamily \#include $<$sys/poll.\-h$>$}\\*
{\ttfamily \#include $<$sys/socket.\-h$>$}\\*
{\ttfamily \#include $<$sys/time.\-h$>$}\\*
{\ttfamily \#include $<$arpa/inet.\-h$>$}\\*
{\ttfamily \#include $<$netinet/in.\-h$>$}\\*
{\ttfamily \#include $<$string.\-h$>$}\\*
{\ttfamily \#include $<$unistd.\-h$>$}\\*
{\ttfamily \#include $<$errno.\-h$>$}\\*
{\ttfamily \#include \char`\"{}mysocket.\-h\char`\"{}}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
static int \hyperlink{mysocket_8c_a5080a3edaaf7fb41f48ace893fca695c}{create\-\_\-listening\-\_\-socket} (int port)
\begin{DoxyCompactList}\small\item\em Create a listening port(socket). \end{DoxyCompactList}\item 
int \hyperlink{mysocket_8c_afdd8e636037a419157873214ac8de1bf}{send\-\_\-to\-\_\-port} (int port, char $\ast$msg)
\begin{DoxyCompactList}\small\item\em Send message to connecting sockets according to the distination port. \end{DoxyCompactList}\item 
void \hyperlink{mysocket_8c_aa33188a983588ce527b8c21f4db600a6}{poll\-\_\-loop} (int port, \hyperlink{mysocket_8h_ab12da4d3e165d48976cfae67b6b79edf}{conn\-\_\-callback} conn\-\_\-cb, \hyperlink{mysocket_8h_a3c1703ca99d5de589e556abf082516f4}{timeout\-\_\-callback} timeout\-\_\-cb, int timeout)
\begin{DoxyCompactList}\small\item\em Loop waiting any connection, msg or timeout then callback. \end{DoxyCompactList}\item 
int \hyperlink{mysocket_8c_ab2056969d2ac9b09afc4f5f62a9cb468}{create\-\_\-connection} (char $\ast$ip, int port)
\begin{DoxyCompactList}\small\item\em Start a socket to target I\-P\-:Port. \end{DoxyCompactList}\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
static struct pollfd \hyperlink{mysocket_8c_affadfb60e0ae9366feaedd950ef5cd28}{fds} \mbox{[}200\mbox{]}
\item 
static int \hyperlink{mysocket_8c_a0968571d264411bba407e2ba2f4814b9}{nfds} = 2
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\hypertarget{mysocket_8c_ab2056969d2ac9b09afc4f5f62a9cb468}{\index{mysocket.\-c@{mysocket.\-c}!create\-\_\-connection@{create\-\_\-connection}}
\index{create\-\_\-connection@{create\-\_\-connection}!mysocket.c@{mysocket.\-c}}
\subsubsection[{create\-\_\-connection}]{\setlength{\rightskip}{0pt plus 5cm}int create\-\_\-connection (
\begin{DoxyParamCaption}
\item[{char $\ast$}]{ip, }
\item[{int}]{port}
\end{DoxyParamCaption}
)}}\label{mysocket_8c_ab2056969d2ac9b09afc4f5f62a9cb468}


Start a socket to target I\-P\-:Port. 


\begin{DoxyParams}{Parameters}
{\em ip} & target ip address (eg.\char`\"{}127.\-0.\-0.\-1\char`\"{}) \\
\hline
{\em port} & target port address \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em 0} & success \\
\hline
{\em $<$0} & connection fail \\
\hline
\end{DoxyRetVals}


Definition at line 320 of file mysocket.\-c.

\hypertarget{mysocket_8c_a5080a3edaaf7fb41f48ace893fca695c}{\index{mysocket.\-c@{mysocket.\-c}!create\-\_\-listening\-\_\-socket@{create\-\_\-listening\-\_\-socket}}
\index{create\-\_\-listening\-\_\-socket@{create\-\_\-listening\-\_\-socket}!mysocket.c@{mysocket.\-c}}
\subsubsection[{create\-\_\-listening\-\_\-socket}]{\setlength{\rightskip}{0pt plus 5cm}int create\-\_\-listening\-\_\-socket (
\begin{DoxyParamCaption}
\item[{int}]{port}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [static]}}}\label{mysocket_8c_a5080a3edaaf7fb41f48ace893fca695c}


Create a listening port(socket). 


\begin{DoxyParams}{Parameters}
{\em port} & listen to which port \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em $>$0} & file descriptor for the new socket \\
\hline
{\em -\/1} & failed to create a listening socket \\
\hline
\end{DoxyRetVals}


Definition at line 29 of file mysocket.\-c.

\hypertarget{mysocket_8c_aa33188a983588ce527b8c21f4db600a6}{\index{mysocket.\-c@{mysocket.\-c}!poll\-\_\-loop@{poll\-\_\-loop}}
\index{poll\-\_\-loop@{poll\-\_\-loop}!mysocket.c@{mysocket.\-c}}
\subsubsection[{poll\-\_\-loop}]{\setlength{\rightskip}{0pt plus 5cm}void poll\-\_\-loop (
\begin{DoxyParamCaption}
\item[{int}]{port, }
\item[{{\bf conn\-\_\-callback}}]{conn\-\_\-cb, }
\item[{{\bf timeout\-\_\-callback}}]{timeout\-\_\-cb, }
\item[{int}]{timeout}
\end{DoxyParamCaption}
)}}\label{mysocket_8c_aa33188a983588ce527b8c21f4db600a6}


Loop waiting any connection, msg or timeout then callback. 


\begin{DoxyParams}{Parameters}
{\em port} & listening to which port \\
\hline
{\em conn\-\_\-cb} & callback after receiving a msg \\
\hline
{\em timeout\-\_\-cb} & callback after timeout \\
\hline
{\em timeout} & timeout the listen in millisecond \\
\hline
\end{DoxyParams}


Definition at line 108 of file mysocket.\-c.

\hypertarget{mysocket_8c_afdd8e636037a419157873214ac8de1bf}{\index{mysocket.\-c@{mysocket.\-c}!send\-\_\-to\-\_\-port@{send\-\_\-to\-\_\-port}}
\index{send\-\_\-to\-\_\-port@{send\-\_\-to\-\_\-port}!mysocket.c@{mysocket.\-c}}
\subsubsection[{send\-\_\-to\-\_\-port}]{\setlength{\rightskip}{0pt plus 5cm}int send\-\_\-to\-\_\-port (
\begin{DoxyParamCaption}
\item[{int}]{port, }
\item[{char $\ast$}]{msg}
\end{DoxyParamCaption}
)}}\label{mysocket_8c_afdd8e636037a419157873214ac8de1bf}


Send message to connecting sockets according to the distination port. 


\begin{DoxyParams}{Parameters}
{\em port} & the destination port \\
\hline
{\em msg} & msg needed to send out \\
\hline
\end{DoxyParams}

\begin{DoxyRetVals}{Return values}
{\em number} & of connections sended by this function \\
\hline
\end{DoxyRetVals}


Definition at line 87 of file mysocket.\-c.



\subsection{Variable Documentation}
\hypertarget{mysocket_8c_affadfb60e0ae9366feaedd950ef5cd28}{\index{mysocket.\-c@{mysocket.\-c}!fds@{fds}}
\index{fds@{fds}!mysocket.c@{mysocket.\-c}}
\subsubsection[{fds}]{\setlength{\rightskip}{0pt plus 5cm}struct pollfd fds\mbox{[}200\mbox{]}\hspace{0.3cm}{\ttfamily [static]}}}\label{mysocket_8c_affadfb60e0ae9366feaedd950ef5cd28}
listening sockets 

Definition at line 24 of file mysocket.\-c.

\hypertarget{mysocket_8c_a0968571d264411bba407e2ba2f4814b9}{\index{mysocket.\-c@{mysocket.\-c}!nfds@{nfds}}
\index{nfds@{nfds}!mysocket.c@{mysocket.\-c}}
\subsubsection[{nfds}]{\setlength{\rightskip}{0pt plus 5cm}int nfds = 2\hspace{0.3cm}{\ttfamily [static]}}}\label{mysocket_8c_a0968571d264411bba407e2ba2f4814b9}
number of listening sockets + 1 

Definition at line 27 of file mysocket.\-c.

